(()=>{var e={528:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var a=r(81),n=r.n(a),o=r(879),l=r.n(o)()(n());l.push([e.id,".ClusterPage{padding:calc(var(--padding)*2)}.ClusterPage header{padding:var(--padding)}.ClusterPage .controls{margin-right:0;margin-left:auto;flex-flow:row;display:flex;gap:10px}",""]);const s=l},576:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var a=r(81),n=r.n(a),o=r(879),l=r.n(o)()(n());l.push([e.id,".KubescapeControlTable{width:100%;height:100%}.KubescapeControlTable .progressStatus{flex-grow:1;display:flex;flex-direction:column;align-items:center;width:100%;row-gap:10px}.Table{background:var(--contentColor);border-top:1px solid var(--tableHeaderBorderColor)}.Table .TableCell.controlId{max-width:80px}.Table .TableCell.severity{max-width:80px}.Table .TableCell.failedResources{max-width:140px}.Table .TableCell.allResources{max-width:120px}.Table .TableCell.riskScore{max-width:90px}.Table .TableCell.status{max-width:80px}.Table .TableCell.controlDescription{word-break:break-word;flex:1.5}",""]);const s=l},879:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",a=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),a&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),a&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,a,n,o){"string"==typeof e&&(e=[[null,e,void 0]]);var l={};if(a)for(var s=0;s<this.length;s++){var i=this[s][0];null!=i&&(l[i]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);a&&l[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),n&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=n):u[4]="".concat(n)),t.push(u))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},703:(e,t,r)=>{"use strict";var a=r(414);function n(){}function o(){}o.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,o,l){if(l!==a){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:n};return r.PropTypes=r,r}},697:(e,t,r)=>{e.exports=r(703)()},414:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},222:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(379),n=r.n(a),o=r(795),l=r.n(o),s=r(569),i=r.n(s),c=r(565),u=r.n(c),d=r(216),p=r.n(d),f=r(589),b=r.n(f),m=r(528),v={};v.styleTagTransform=b(),v.setAttributes=u(),v.insert=i().bind(null,"head"),v.domAPI=l(),v.insertStyleElement=p(),n()(m.Z,v);const g=m.Z&&m.Z.locals?m.Z.locals:void 0},29:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(379),n=r.n(a),o=r(795),l=r.n(o),s=r(569),i=r.n(s),c=r(565),u=r.n(c),d=r(216),p=r.n(d),f=r(589),b=r.n(f),m=r(576),v={};v.styleTagTransform=b(),v.setAttributes=u(),v.insert=i().bind(null,"head"),v.domAPI=l(),v.insertStyleElement=p(),n()(m.Z,v);const g=m.Z&&m.Z.locals?m.Z.locals:void 0},379:e=>{"use strict";var t=[];function r(e){for(var r=-1,a=0;a<t.length;a++)if(t[a].identifier===e){r=a;break}return r}function a(e,a){for(var o={},l=[],s=0;s<e.length;s++){var i=e[s],c=a.base?i[0]+a.base:i[0],u=o[c]||0,d="".concat(c," ").concat(u);o[c]=u+1;var p=r(d),f={css:i[1],media:i[2],sourceMap:i[3],supports:i[4],layer:i[5]};if(-1!==p)t[p].references++,t[p].updater(f);else{var b=n(f,a);a.byIndex=s,t.splice(s,0,{identifier:d,updater:b,references:1})}l.push(d)}return l}function n(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,n){var o=a(e=e||[],n=n||{});return function(e){e=e||[];for(var l=0;l<o.length;l++){var s=r(o[l]);t[s].references--}for(var i=a(e,n),c=0;c<o.length;c++){var u=r(o[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}o=i}}},569:e=>{"use strict";var t={};e.exports=function(e,r){var a=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(r)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var a="";r.supports&&(a+="@supports (".concat(r.supports,") {")),r.media&&(a+="@media ".concat(r.media," {"));var n=void 0!==r.layer;n&&(a+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),a+=r.css,n&&(a+="}"),r.media&&(a+="}"),r.supports&&(a+="}");var o=r.sourceMap;o&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},553:function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(104)),o=r(361),l=r(931),s=r(338),i=r(645),c=r(740),u=r(547),d=r(245);class p extends l.Renderer.LensExtension{constructor(){super(...arguments),Object.defineProperty(this,"clusterPages",{enumerable:!0,configurable:!0,writable:!0,value:[{id:"kubescape-main",components:{Page:()=>n.default.createElement(c.ClusterPage,null)}}]}),Object.defineProperty(this,"clusterPageMenus",{enumerable:!0,configurable:!0,writable:!0,value:[{target:{pageId:"kubescape-main"},title:"Kubescape",components:{Icon:c.ClusterPageIcon}}]}),Object.defineProperty(this,"kubeObjectDetailItems",{enumerable:!0,configurable:!0,writable:!0,value:[{kind:"Node",apiVersions:["v1"],priority:9,components:{Details:e=>n.default.createElement(c.KubescapeWorkloadDetails,Object.assign({},e))}},{kind:"Pod",apiVersions:["v1"],priority:10,components:{Details:e=>n.default.createElement(c.KubescapeWorkloadDetails,Object.assign({},e))}},{kind:"Deployment",apiVersions:["apps/v1"],priority:10,components:{Details:e=>n.default.createElement(c.KubescapeWorkloadDetails,Object.assign({},e))}},{kind:"DaemonSet",apiVersions:["apps/v1"],priority:10,components:{Details:e=>n.default.createElement(c.KubescapeWorkloadDetails,Object.assign({},e))}},{kind:"StatefulSet",apiVersions:["apps/v1"],priority:10,components:{Details:e=>n.default.createElement(c.KubescapeWorkloadDetails,Object.assign({},e))}},{kind:"ReplicaSet",apiVersions:["apps/v1"],priority:10,components:{Details:e=>n.default.createElement(c.KubescapeWorkloadDetails,Object.assign({},e))}},{kind:"ServiceAccount",apiVersions:["v1"],priority:10,components:{Details:e=>n.default.createElement(c.KubescapeWorkloadDetails,Object.assign({},e))}},{kind:"CronJob",apiVersions:["batch/v1beta1"],components:{Details:e=>n.default.createElement(c.KubescapeWorkloadDetails,Object.assign({},e))}}]}),Object.defineProperty(this,"disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]})}async onActivate(){i.Logger.debug("Kubescape activated");const e=s.IpcRenderer.createInstance(this),t=u.KubescapePreferenceStore.createInstance();t.loadExtension(this);const r=u.KubescapeReportStore.createInstance();r.loadExtension(this),this.disposers.push((0,o.reaction)((()=>l.Renderer.Catalog.catalogEntities.activeEntity),(async()=>await(0,d.scanClusterTask)(t,r,e)))),this.disposers.push((0,o.reaction)((()=>t.isInstalled),(async()=>await(0,d.scanClusterTask)(t,r,e))))}async onDeactivate(){i.Logger.debug("Kubescape deactivated"),this.disposers.forEach((e=>e()))}}t.default=p},673:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var n,o=arguments.length,l=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(o<3?n(l):o>3?n(t,r,l):n(t,r))||l);return o>3&&l&&Object.defineProperty(t,r,l),l},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ClusterPage=t.ClusterPageIcon=void 0;const o=n(r(104)),l=r(931),s=r(361),i=r(93),c=r(740),u=r(547),{Component:{Button:d,Icon:p,TabLayout:f,SearchInput:b}}=l.Renderer;r(222);const m=r(338),v=r(245);t.ClusterPageIcon=function(e){return o.default.createElement(l.Renderer.Component.Icon,null,o.default.createElement(c.KubescapeIcon,Object.assign({fill:"currentColor",size:"16"},e)))};let g=class extends o.default.Component{constructor(e){super(e),Object.defineProperty(this,"controlTableSearch",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"scanCluster",{enumerable:!0,configurable:!0,writable:!0,value:async()=>{const e=this.reportStore.scanResults.filter((e=>e.clusterId!=this.reportStore.activeClusterId));this.reportStore.scanResults=e,await(0,v.scanClusterTask)(this.preferenceStore,this.reportStore,this.ipc)}}),Object.defineProperty(this,"configInfo",{enumerable:!0,configurable:!0,writable:!0,value:()=>this.isInstalled?o.default.createElement(o.default.Fragment,null,o.default.createElement("p",null,"Version: ",o.default.createElement("i",null,this.config.version)),o.default.createElement("p",null,"Base directory: ",o.default.createElement("i",null,this.config.baseDirectory))):o.default.createElement("div",{className:"KubescapeControlTable flex center"},o.default.createElement(l.Renderer.Component.Spinner,null),o.default.createElement("span",null,"Initializing"))}),(0,s.makeObservable)(this)}get preferenceStore(){return u.KubescapePreferenceStore.getInstance()}get reportStore(){return u.KubescapeReportStore.getInstance()}get ipc(){return m.IpcRenderer.getInstance()}get isInstalled(){return this.preferenceStore.isInstalled}get config(){return this.preferenceStore.kubescapeConfig}get scanTime(){return new Date(this.reportStore.activeClusterReportResult.time).toLocaleTimeString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})}render(){const e=[c.controlTableColumn.status,c.controlTableColumn.severity,c.controlTableColumn.id,c.controlTableColumn.name,c.controlTableColumn.failedResources,c.controlTableColumn.allResources,c.controlTableColumn.riskScore];return o.default.createElement(f,{className:"ClusterPage"},o.default.createElement("header",{className:"flex gaps align-center"},o.default.createElement("h2",{className:"flex gaps align-center"},o.default.createElement(c.KubescapeIcon,{size:50}),o.default.createElement("span",null,"Kubescape"),o.default.createElement(p,{material:"info",tooltip:this.configInfo()})),o.default.createElement("div",{className:"controls"},this.reportStore.isScanReady?o.default.createElement(b,{value:this.controlTableSearch,theme:"round-black",onChange:e=>{this.controlTableSearch=e}},o.default.createElement(p,{material:"search"})):null,o.default.createElement(d,{label:"Scan",onClick:this.scanCluster,primary:!0,waiting:!this.reportStore.isScanReady,disabled:!this.reportStore.isScanReady,hidden:!this.isInstalled}),this.reportStore.isScanReady?o.default.createElement("div",null,o.default.createElement("i",null,o.default.createElement("div",null,"Last scan: "),o.default.createElement("div",null,this.scanTime))):null)),o.default.createElement(c.KubescapeControlTable,{search:this.controlTableSearch,columns:e,sortByDefault:{sortBy:c.controlTableColumn.status,orderBy:"desc"}}))}};a([s.observable],g.prototype,"controlTableSearch",void 0),a([s.computed],g.prototype,"preferenceStore",null),a([s.computed],g.prototype,"reportStore",null),a([s.computed],g.prototype,"ipc",null),a([s.computed],g.prototype,"isInstalled",null),a([s.computed],g.prototype,"config",null),a([s.computed],g.prototype,"scanTime",null),a([s.action],g.prototype,"scanCluster",void 0),g=a([i.observer],g),t.ClusterPage=g},349:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var n,o=arguments.length,l=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(o<3?n(l):o>3?n(t,r,l):n(t,r))||l);return o>3&&l&&Object.defineProperty(t,r,l),l},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KubescapeControlDetails=void 0;const o=n(r(104)),l=r(931),s=r(361),i=r(93),c=r(599),u=r(420),d=r(547),{Component:{Drawer:p,DrawerItem:f,DrawerTitle:b,Icon:m,Table:v,TableHead:g,TableCell:h,TableRow:y}}=l.Renderer;class C{constructor(e){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kind",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"namespace",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"detailsUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.assign(this,e)}}class R extends C{constructor(){super(...arguments),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"roleBinding",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}}let O=class extends o.default.Component{constructor(e){super(e),Object.defineProperty(this,"failedResources",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resolveFailedResources",{enumerable:!0,configurable:!0,writable:!0,value:async()=>{if(!this.control)return null;const e=(0,c.getRelatedObjectsFromControl)(this.control.rawResult);return await Promise.all(e.map((async e=>{var t;if(null===(t=e.metadata)||void 0===t?void 0:t.uid){const t=await this.store.getKubeObject(e.metadata.namespace,e.kind,e.apiVersion,e.metadata.uid);return new C({id:e.metadata.uid,name:t.getName(),kind:t.kind,namespace:t.metadata.namespace,detailsUrl:l.Renderer.Navigation.getDetailsUrl(t.selfLink)})}const r=new R({kind:e.kind,name:e.name,namespace:e.namespace});for(const t of e.relatedObjects){const e=await this.store.getKubeObject(t.metadata.namespace,t.kind,t.apiVersion,t.metadata.uid);t.kind.includes("RoleBinding")?r.roleBinding=new C({name:e.getName(),detailsUrl:l.Renderer.Navigation.getDetailsUrl(e.selfLink)}):r.role=new C({name:e.getName(),detailsUrl:l.Renderer.Navigation.getDetailsUrl(e.selfLink)})}return r})))}}),Object.defineProperty(this,"navigationLink",{enumerable:!0,configurable:!0,writable:!0,value:e=>o.default.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),l.Renderer.Navigation.navigate(e.detailsUrl),this.props.onClose()}},e.name)}),(0,s.makeObservable)(this)}get control(){return this.props.control}get store(){return d.KubescapeReportStore.getInstance()}async componentDidMount(){(0,i.disposeOnUnmount)(this,[(0,s.reaction)((()=>this.control),(async()=>{this.failedResources=null;const e=await this.resolveFailedResources();(0,s.runInAction)((()=>{this.failedResources=e}))}))])}get title(){return this.control?`${this.control.id} - ${this.control.name}`:null}get controlDetails(){return this.control?o.default.createElement(o.default.Fragment,null,o.default.createElement(b,null,this.control.name),o.default.createElement(f,{name:"Description"},this.control.description),o.default.createElement(f,{name:"Severity"},o.default.createElement(u.KubescapeControlSeverity,{control:this.control})),o.default.createElement(f,{name:"Remediation"},this.control.remediation),o.default.createElement(f,{name:"More Information"},o.default.createElement("a",{target:"_blank",href:(0,c.docsUrl)(this.control)},o.default.createElement(m,{material:"open_in_browser"})))):null}get failedResourcesTable(){if(!this.failedResources||0==this.failedResources.length)return null;let e;return e=this.failedResources[0]instanceof R?[{title:"Namespace",value:e=>e.namespace},{title:"Role",value:e=>this.navigationLink(e.role)},{title:"RoleBinding",value:e=>this.navigationLink(e.roleBinding)},{title:"Subject",value:e=>e.name}]:[{title:"Namespace",value:e=>e.namespace},{title:"Kind",value:e=>e.kind},{title:"Name",value:e=>this.navigationLink(e)}],o.default.createElement(o.default.Fragment,null,o.default.createElement(b,null,"Failed Resources"),o.default.createElement(v,null,o.default.createElement(g,null,e.map((e=>o.default.createElement(h,null,e.title)))),this.failedResources.map((t=>o.default.createElement(y,null,e.map((e=>o.default.createElement(h,null,e.value(t)))))))))}render(){const{onClose:e}=this.props;return o.default.createElement(p,{className:"KubeObjectDetails flex column",open:null!=this.control,title:this.title,toolbar:null,onClose:e},this.controlDetails,this.failedResourcesTable)}};a([s.observable],O.prototype,"failedResources",void 0),a([s.computed],O.prototype,"control",null),a([s.computed],O.prototype,"store",null),a([s.computed],O.prototype,"title",null),a([s.computed],O.prototype,"controlDetails",null),a([s.computed],O.prototype,"failedResourcesTable",null),O=a([i.observer],O),t.KubescapeControlDetails=O},420:function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KubescapeControlSeverity=void 0;const n=a(r(104)),o=r(931),{Component:{Badge:l}}=o.Renderer;class s extends n.default.Component{render(){const{control:e,isDisabled:t}=this.props,r=t?`${e.severity.color}66`:e.severity.color;return n.default.createElement(l,{style:{backgroundColor:r,color:"white",width:70,textAlign:"center"},label:e.severity.name})}}t.KubescapeControlSeverity=s},997:function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KubescapeControlStatus=void 0;const n=a(r(104)),o=r(931),{Component:{Icon:l}}=o.Renderer;class s extends n.default.Component{render(){const{control:e}=this.props;return n.default.createElement(l,{material:e.status.icon,style:{color:e.status.color},tooltip:e.status.title})}}t.KubescapeControlStatus=s},253:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var n,o=arguments.length,l=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(o<3?n(l):o>3?n(t,r,l):n(t,r))||l);return o>3&&l&&Object.defineProperty(t,r,l),l},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KubescapeControlTable=t.controlTableColumn=void 0;const o=n(r(104)),l=r(361),s=r(93),i=r(931),c=r(547),u=r(740),d=r(599),p=r(928);r(29);const{Component:{TableHead:f,TableRow:b,TableCell:m,Table:v,Spinner:g,Tooltip:h}}=i.Renderer;var y;!function(e){e.id="id",e.name="name",e.failedResources="failedResources",e.allResources="allResources",e.riskScore="riskScore",e.severity="severity",e.description="description",e.status="status",e.remediation="remediation"}(y=t.controlTableColumn||(t.controlTableColumn={}));let C=class extends o.default.Component{constructor(e){super(e),Object.defineProperty(this,"selectedControl",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"onRowClick",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t;e.id==(null===(t=this.selectedControl)||void 0===t?void 0:t.id)?this.selectedControl=null:this.selectedControl=e}}),Object.defineProperty(this,"getTableRow",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t;let r=(0,p.prevDefault)((()=>this.onRowClick(e)));return this.props.disableRowClick&&(r=()=>null),o.default.createElement(b,{onClick:r,key:e.id,sortItem:e,nowrap:null===(t=this.props.nowrap)||void 0===t||t},this.columns.map((t=>o.default.createElement(m,{className:t.className},t.value(e)))))}}),Object.defineProperty(this,"sortingCallbacks",{enumerable:!0,configurable:!0,writable:!0,value:{[y.id]:e=>e.id,[y.name]:e=>e.name,[y.failedResources]:e=>e.failedResources,[y.allResources]:e=>e.allResources,[y.riskScore]:e=>e.riskScore,[y.severity]:e=>e.severity.value,[y.description]:e=>e.description,[y.status]:e=>e.status.value*e.severity.value,[y.remediation]:e=>e.remediation}}),Object.defineProperty(this,"getControlString",{enumerable:!0,configurable:!0,writable:!0,value:e=>`${e.severity.name}${e.id}${e.name}`.toLowerCase()}),(0,l.makeObservable)(this)}get store(){return c.KubescapeReportStore.getInstance()}get statusString(){return c.KubescapePreferenceStore.getInstance().isInstalled?"Cluster scan in progress":"Initializing Extension..."}get columns(){const e=[{id:y.status,title:"Status",className:"status",value:e=>o.default.createElement(u.KubescapeControlStatus,{control:e})},{id:y.severity,title:"Severity",className:"severity",value:e=>o.default.createElement(u.KubescapeControlSeverity,{isDisabled:0===e.failedResources,control:e})},{id:y.id,title:"ID",className:"controlId",value:e=>e.id},{id:y.name,title:"Control Name",className:"controlName",value:e=>e.name},{id:y.description,title:"Description",className:"controlDescription",value:e=>e.description},{id:y.failedResources,title:"Failed Resources",className:"failedResources",value:e=>e.failedResources},{id:y.allResources,title:"All Resources",className:"allResources",value:e=>e.allResources},{id:y.riskScore,title:"Risk Score",className:"riskScore",value:e=>`${Math.round(e.riskScore)}%`},{id:y.remediation,title:"Remediation",className:"remediation",value:e=>e.remediation}];if(this.props.linkToDocsColumnName){const t=e.find((e=>e.id==this.props.linkToDocsColumnName)),r=t.value;t.value=e=>o.default.createElement("a",{target:"_blank",href:(0,d.docsUrl)(e)},r(e))}if(this.props.descriptionTooltipColumnName){const t=e.find((e=>e.id==this.props.descriptionTooltipColumnName)),r=t.value;t.value=e=>o.default.createElement(o.default.Fragment,null,o.default.createElement("span",{id:e.id},r(e)),o.default.createElement(h,{targetId:e.id},e.description))}return this.props.columns?e.filter((e=>this.props.columns.includes(e.id))):e}get getTableHeader(){return o.default.createElement(f,{sticky:!0},this.columns.map((e=>o.default.createElement(m,{key:e.title,className:e.className,sortBy:e.id},e.title))))}get tableItems(){let e=this.props.controls?this.props.controls:this.store.kubescapeControls;if(this.props.search){const t=this.props.search.toLowerCase();e=e.filter((e=>this.getControlString(e).includes(t)))}return e}render(){if(!this.store.isScanReady)return o.default.createElement("div",{className:"KubescapeControlTable flex center"},o.default.createElement("div",{className:"progressStatus"},o.default.createElement(g,null),o.default.createElement("span",null,this.statusString)));const{sortByDefault:e,disableRowClick:t}=this.props;return o.default.createElement(o.default.Fragment,null,o.default.createElement(u.KubescapeControlDetails,{control:this.selectedControl,onClose:()=>{this.selectedControl=null}}),o.default.createElement(v,{tableId:"controlReportsTable",selectable:!t,sortable:this.sortingCallbacks,sortByDefault:e,renderRow:this.getTableRow,items:this.tableItems},this.getTableHeader))}};a([l.observable],C.prototype,"selectedControl",void 0),a([l.computed],C.prototype,"store",null),a([l.computed],C.prototype,"statusString",null),a([l.computed],C.prototype,"getTableHeader",null),a([l.computed],C.prototype,"tableItems",null),C=a([s.observer],C),t.KubescapeControlTable=C},230:function(e,t,r){"use strict";var a=this&&this.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KubescapeIcon=void 0;const o=n(r(104)),l=n(r(697));t.KubescapeIcon=function(e){var{size:t,fill:r=null}=e,n=a(e,["size","fill"]);return o.default.createElement("svg",Object.assign({},n,{viewBox:"0 0 201.06 199.56",width:t,height:t,style:{fill:r}}),o.default.createElement("defs",null,o.default.createElement("style",null,`.cls-1 { fill: ${null!=r?r:"url(#linear-gradient)"};}`,`.cls-2 { fill: ${null!=r?r:"#2916fc"};}`,`.cls-3,.cls-5{ fill: ${null!=r?r:"#fff"};}`,`.cls-4 { fill: ${null!=r?r:"#000d33"};}`,".cls-5 { opacity:0.76;}",`.cls-6 { fill: ${null!=r?r:"url(#linear-gradient-2)"};}`),o.default.createElement("linearGradient",{id:"linear-gradient",x1:"957.13",y1:"569.56",x2:"1031.5",y2:"569.56",gradientUnits:"userSpaceOnUse"},o.default.createElement("stop",{offset:"0","stop-color":"#ff7879"}),o.default.createElement("stop",{offset:"0.21","stop-color":"#fc777b"}),o.default.createElement("stop",{offset:"0.36","stop-color":"#f27281"}),o.default.createElement("stop",{offset:"0.5","stop-color":"#e26b8a"}),o.default.createElement("stop",{offset:"0.63","stop-color":"#cb6098"}),o.default.createElement("stop",{offset:"0.75","stop-color":"#ae52aa"}),o.default.createElement("stop",{offset:"0.86","stop-color":"#8a41c0"}),o.default.createElement("stop",{offset:"0.98","stop-color":"#602eda"}),o.default.createElement("stop",{offset:"1","stop-color":"#5529e0"})),o.default.createElement("linearGradient",{id:"linear-gradient-2",x1:"996.83",y1:"577.49",x2:"1031.52",y2:"577.49",xlinkHref:"#linear-gradient"})),o.default.createElement("path",{className:"cls-1",d:"M1031.5,547.77l-33.13,57.36a11.32,11.32,0,0,1-1.54,2.08h-18l-16.77-29.05-5-8.61,8.5-14.72,7-12.07,6.27-10.85h43.48Z",transform:"translate(-859.72 -452.72)"}),o.default.createElement("path",{className:"cls-2",d:"M1037.28,537.75l-5.78,10-9.16-15.86H978.86l-6.27,10.85-7,12.07-8.5,14.72,5,8.61,16.77,29.05h18a11.72,11.72,0,0,1-8.64,3.8H910.38a11.75,11.75,0,0,1-10.18-5.88l-38.9-67.38a11.78,11.78,0,0,1,0-11.77l38.9-67.38a11.77,11.77,0,0,1,10.18-5.88h77.81a11.77,11.77,0,0,1,10.18,5.88L1037.28,526A11.78,11.78,0,0,1,1037.28,537.75Z",transform:"translate(-859.72 -452.72)"}),o.default.createElement("path",{className:"cls-3",d:"M939.94,492.05h-13.8a3.69,3.69,0,0,0-3.7,3.7V568a3.69,3.69,0,0,0,3.7,3.69h13.8a4.21,4.21,0,0,0,.62,0,3.7,3.7,0,0,0,3.08-3.64V495.75A3.7,3.7,0,0,0,939.94,492.05Zm23.31,33.58,1.24-1.83,2.09-3.11L982,497.81a3.69,3.69,0,0,0-3.06-5.76H965.81a3.68,3.68,0,0,0-3.12,1.72l-19.05,30-2.3,3.63a3.73,3.73,0,0,0-.11,3.78l2.41,4.35L950.52,548l9.34,16.85,5.77-10,6.13-10.61-8.63-14.64a3.69,3.69,0,0,1-.43-2.69A3.81,3.81,0,0,1,963.25,525.63Z",transform:"translate(-859.72 -452.72)"}),o.default.createElement("path",{className:"cls-4",d:"M1060.08,565a14.64,14.64,0,0,0-1.3-3l-22.56-39.08a15.09,15.09,0,0,0-13.06-7.53H978a15.15,15.15,0,0,0-13,7.53l-.49.86-1.79,3.09L956,538.5,950.52,548l-6.88,11.93L942.42,562l-.12.23a15.18,15.18,0,0,0,.12,14.85L965,616.17a15.13,15.13,0,0,0,13,7.54h45.13a14.19,14.19,0,0,0,1.47-.07l16,25.61a6.51,6.51,0,0,0,8.93,2l1-.61a6.49,6.49,0,0,0,2.07-8.92l-16.23-25.92,22.38-38.75A15.16,15.16,0,0,0,1060.08,565Zm-20.92,13.09-16.82,29.14H978.86L962.1,578.16l-5-8.61,2.73-4.72,5.77-10,6.13-10.61.84-1.46,6.26-10.85h43.48l9.18,15.89,12.55,21.75Z",transform:"translate(-859.72 -452.72)"}),o.default.createElement("path",{className:"cls-5",d:"M981.48,571.68H965.84a3.72,3.72,0,0,1-3.24-1.9l-2.74-4.95,5.77-10,6.13-10.61,12.9,21.89A3.69,3.69,0,0,1,981.48,571.68Z",transform:"translate(-859.72 -452.72)"}),o.default.createElement("path",{className:"cls-6",d:"M1031.52,547.81l-34.31,59.4h-.38a11.32,11.32,0,0,0,1.54-2.08l33.13-57.36Z",transform:"translate(-859.72 -452.72)"}))},t.KubescapeIcon.propTypes={size:l.default.number,fill:l.default.string},t.KubescapeIcon.defaultProps={size:16}},440:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var n,o=arguments.length,l=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(o<3?n(l):o>3?n(t,r,l):n(t,r))||l);return o>3&&l&&Object.defineProperty(t,r,l),l},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KubescapePreferenceHint=t.KubescapePreferenceInput=void 0;const o=r(931),l=n(r(104)),s=r(547),i=r(93),c=r(361),{Component:u}=o.Renderer;let d=class extends l.default.Component{constructor(e){var t,r,a,n,o,l,i,u,d,p,f;super(e),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:null!==(r=null===(t=s.KubescapePreferenceStore.getInstance().kubescapeConfig)||void 0===t?void 0:t.version)&&void 0!==r?r:""}),Object.defineProperty(this,"frameworksDirectory",{enumerable:!0,configurable:!0,writable:!0,value:null!==(n=null===(a=s.KubescapePreferenceStore.getInstance().kubescapeConfig)||void 0===a?void 0:a.frameworksDirectory)&&void 0!==n?n:""}),Object.defineProperty(this,"baseDirectory",{enumerable:!0,configurable:!0,writable:!0,value:null!==(l=null===(o=s.KubescapePreferenceStore.getInstance().kubescapeConfig)||void 0===o?void 0:o.baseDirectory)&&void 0!==l?l:""}),Object.defineProperty(this,"requiredFrameworks",{enumerable:!0,configurable:!0,writable:!0,value:null!==(u=null===(i=s.KubescapePreferenceStore.getInstance().kubescapeConfig)||void 0===i?void 0:i.requiredFrameworks)&&void 0!==u?u:[]}),Object.defineProperty(this,"scanFrameworks",{enumerable:!0,configurable:!0,writable:!0,value:null!==(p=null===(d=s.KubescapePreferenceStore.getInstance().kubescapeConfig)||void 0===d?void 0:d.scanFrameworks)&&void 0!==p?p:[]}),Object.defineProperty(this,"isInstalled",{enumerable:!0,configurable:!0,writable:!0,value:null!==(f=s.KubescapePreferenceStore.getInstance().isInstalled)&&void 0!==f&&f}),Object.defineProperty(this,"isSaving",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"saveChanges",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.isSaving=!0,s.KubescapePreferenceStore.getInstance().kubescapeConfig={version:this.version,frameworksDirectory:this.frameworksDirectory,baseDirectory:this.baseDirectory,requiredFrameworks:this.requiredFrameworks,scanFrameworks:this.scanFrameworks},this.isSaving=!1}}),Object.defineProperty(this,"onChange",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{this[t.target.name]=e}}),(0,c.makeObservable)(this)}render(){return l.default.createElement("div",{className:"flex column gaps"},l.default.createElement(l.default.Fragment,null,l.default.createElement("span",null,"Some Text"),l.default.createElement(u.Input,{dirty:!1,name:"version",onChange:this.onChange,placeholder:"Version",theme:"round-black",validators:[u.InputValidators.isRequired],value:this.version}),l.default.createElement(u.Input,{dirty:!1,name:"frameworksDirectory",onChange:this.onChange,placeholder:"Frameworks Directory",theme:"round-black",validators:[u.InputValidators.isRequired],value:this.frameworksDirectory}),l.default.createElement(u.Input,{dirty:!1,name:"baseDirectory",onChange:this.onChange,placeholder:"Base Directory",theme:"round-black",validators:[u.InputValidators.isRequired],value:this.baseDirectory})),l.default.createElement("div",{className:"flex column gaps align-flex-start"},l.default.createElement(u.Button,{label:"Save",onClick:this.saveChanges,primary:!0,waiting:this.isSaving,hidden:!s.KubescapePreferenceStore.getInstance().isInstalled})))}};a([c.observable],d.prototype,"version",void 0),a([c.observable],d.prototype,"frameworksDirectory",void 0),a([c.observable],d.prototype,"baseDirectory",void 0),a([c.observable],d.prototype,"requiredFrameworks",void 0),a([c.observable],d.prototype,"scanFrameworks",void 0),a([c.observable],d.prototype,"isInstalled",void 0),a([c.observable],d.prototype,"isSaving",void 0),d=a([i.observer],d),t.KubescapePreferenceInput=d;class p extends l.default.Component{render(){return l.default.createElement("span",null)}}t.KubescapePreferenceHint=p},829:function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KubescapeWorkloadDetails=void 0;const n=r(931),o=r(361),l=a(r(104)),s=r(599),i=r(547),c=r(740),{Component:{DrawerTitle:u}}=n.Renderer;class d extends l.default.Component{constructor(e){super(e)}render(){const e=(0,o.toJS)(i.KubescapeReportStore.getInstance().activeClusterReportResult.controls),t=(0,s.getFailedControlsById)(e,this.props.object.getId()),r=[c.controlTableColumn.severity,c.controlTableColumn.name,c.controlTableColumn.remediation],a={sortBy:c.controlTableColumn.id,orderBy:"desc"};return t.length>0?l.default.createElement("div",null,l.default.createElement(u,null,"Kubescape - Failed Controls"),l.default.createElement(c.KubescapeControlTable,{columns:r,controls:t,nowrap:!1,disableRowClick:!0,sortByDefault:a,linkToDocsColumnName:c.controlTableColumn.name,descriptionTooltipColumnName:c.controlTableColumn.name})):null}}t.KubescapeWorkloadDetails=d},740:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,n)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(230),t),n(r(420),t),n(r(829),t),n(r(440),t),n(r(673),t),n(r(253),t),n(r(349),t),n(r(997),t)},338:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcRenderer=void 0;const a=r(931);class n extends a.Renderer.Ipc{}t.IpcRenderer=n},245:function(e,t,r){"use strict";var a=this&&this.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.scanClusterTask=void 0;const n=r(931),o=r(928);t.scanClusterTask=async function(e,t,r){if(!e.isInstalled)return void o.Logger.debug("Kubescape is not installed");const l=n.Renderer.Catalog.catalogEntities.activeEntity;if(!(l&&l instanceof n.Common.Catalog.KubernetesCluster))return void o.Logger.debug("No cluster selected");const s=l.getId(),i=l.getName();let c=t.scanResults.find((e=>e.clusterId==s));if(c){if(!c.isScanning)return void o.Logger.debug(`Cluster '${i}' - already scanned`)}else t.scanResults.push({clusterId:s,clusterName:i,controls:null,frameworks:null,isScanning:!0,time:Date.now()});o.Logger.debug(`Invoking cluster scan on '${i}'`);const u=l.spec.kubeconfigPath,d=l.spec.kubeconfigContext,p=await r.invoke(o.SCAN_CLUSTER_EVENT_NAME,d,u);console.debug(p);const[f,b]=function(e){const t={},r=[];if(Object.keys(e).length<=0)return o.Logger.debug({msg:"Scan cluster ended with no results",result:e}),[[],[]];for(const n of e){const{controlReports:e}=n,o=a(n,["controlReports"]);for(const r of e)r.controlID in t||(t[r.controlID]=r);r.push(o)}return[Object.values(t),r]}(p);c=t.scanResults.find((e=>e.clusterId==s)),c?(c.controls=f,c.frameworks=b,o.Logger.debug(`Saved scan result of cluster '${i}'`),c.isScanning=!1):o.Logger.error("Scan results error - push was not synced")}},599:(e,t)=>{"use strict";function r(e){const t=e.baseScore;return t>=9?{name:"Critical",value:t,color:"#7b2936"}:t>=7?{name:"High",value:t,color:"#cc4d4a"}:t>=4?{name:"Medium",value:t,color:"#e48547"}:t>=1?{name:"Low",value:t,color:"#bf9745"}:{name:"Unknown",value:t,color:"#87909c"}}function a(e){return 0==e.failedResources?e.totalResources>0?{title:"Passed",icon:"check_circle_outline",value:1,color:"#23a71b"}:{title:"Skipped/Irrelevant",icon:"help_outline",value:0,color:"gray"}:{title:"Failed",icon:"highlight_off",value:10,color:"#e1449f"}}function n(e){return{id:e.id,name:e.name,failedResources:e.failedResources,allResources:e.totalResources,riskScore:e.score,description:e.description,remediation:e.remediation,severity:r(e),status:a(e),rawResult:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.docsUrl=t.getRelatedObjectsFromControl=t.getFailedControlsById=t.toKubescapeControl=void 0,t.toKubescapeControl=n,t.getFailedControlsById=function(e,t){return e.filter((e=>{var r;return e.failedResources>0&&(null===(r=e.ruleReports)||void 0===r?void 0:r.some((e=>{var r;return e.failedResources>0&&(null===(r=e.ruleResponses)||void 0===r?void 0:r.some((e=>e.alertObject.k8sApiObjects.some((e=>e.apiVersion?e.metadata.uid==t:!!e.apiGroup&&e.relatedObjects.some((e=>e.metadata.uid==t)))))))})))})).map((e=>n(e)))},t.getRelatedObjectsFromControl=function(e){var t;const r=[];return console.log(e),null===(t=e.ruleReports)||void 0===t||t.forEach((e=>{var t;e.failedResources>0&&(null===(t=e.ruleResponses)||void 0===t||t.forEach((e=>{"failed"==e.ruleStatus&&e.alertObject.k8sApiObjects.forEach((e=>{r.push(e)}))})))})),r},t.docsUrl=function(e){return`https://hub.armo.cloud/docs/${e.id.toLocaleLowerCase()}`}},287:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var n,o=arguments.length,l=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(o<3?n(l):o>3?n(t,r,l):n(t,r))||l);return o>3&&l&&Object.defineProperty(t,r,l),l};Object.defineProperty(t,"__esModule",{value:!0}),t.KubescapePreferenceStore=void 0;const n=r(931),o=r(361),{Store:l}=n.Common;class s extends l.ExtensionStore{constructor(){super({configName:"kubescape-preference-store",defaults:{isInstalled:!1,kubescapeConfig:null}}),Object.defineProperty(this,"kubescapeConfig",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isInstalled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,o.makeObservable)(this)}fromStore({kubescapeConfig:e,isInstalled:t}){this.kubescapeConfig=e,this.isInstalled=t}toJSON(){return{kubescapeConfig:this.kubescapeConfig,isInstalled:this.isInstalled}}}a([o.observable],s.prototype,"kubescapeConfig",void 0),a([o.observable],s.prototype,"isInstalled",void 0),t.KubescapePreferenceStore=s},917:function(e,t,r){"use strict";var a=this&&this.__decorate||function(e,t,r,a){var n,o=arguments.length,l=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(o<3?n(l):o>3?n(t,r,l):n(t,r))||l);return o>3&&l&&Object.defineProperty(t,r,l),l};Object.defineProperty(t,"__esModule",{value:!0}),t.KubescapeReportStore=void 0;const n=r(931),o=r(361),l=r(599),{Store:s}=n.Common;class i extends s.ExtensionStore{constructor(){super({configName:"kubescape-report-store",defaults:{scanResults:[]}}),Object.defineProperty(this,"scanResults",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"getStore",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>n.Renderer.K8sApi.apiManager.getStore(n.Renderer.K8sApi.apiManager.getApiByKind(e,t))}),Object.defineProperty(this,"getKubeObject",{enumerable:!0,configurable:!0,writable:!0,value:async(e,t,r,a)=>{const n=this.getStore(t,r);return n.isLoaded&&n.getById(a)||await n.loadAll({namespaces:[e],merge:!1}),n.getById(a)}}),(0,o.makeObservable)(this)}get activeCluster(){const e=n.Renderer.Catalog.catalogEntities.activeEntity;return e&&e instanceof n.Common.Catalog.KubernetesCluster?e:null}get activeClusterId(){var e,t;return null!==(t=null===(e=this.activeCluster)||void 0===e?void 0:e.getId())&&void 0!==t?t:null}get activeClusterReportResult(){return this.activeClusterId?this.scanResults.find((e=>e.clusterId==this.activeClusterId)):null}get kubescapeControls(){return this.activeClusterReportResult&&this.activeClusterReportResult.controls?this.activeClusterReportResult.controls.map((e=>(0,l.toKubescapeControl)(e))):null}get isScanReady(){return this.activeClusterReportResult&&this.activeClusterReportResult.controls}fromStore({scanResults:e}){this.scanResults=e}toJSON(){return{scanResults:this.scanResults}}}a([o.observable],i.prototype,"scanResults",void 0),a([o.computed],i.prototype,"activeCluster",null),a([o.computed],i.prototype,"activeClusterId",null),a([o.computed],i.prototype,"activeClusterReportResult",null),a([o.computed],i.prototype,"kubescapeControls",null),a([o.computed],i.prototype,"isScanReady",null),t.KubescapeReportStore=i},547:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,n)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(287),t),n(r(917),t)},761:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_KUBESCAPE_FRAMEWORKS=t.DEFAULT_KUBESCAPE_VERSION=t.SCAN_CLUSTER_EVENT_NAME=void 0,t.SCAN_CLUSTER_EVENT_NAME="scanCluster",t.DEFAULT_KUBESCAPE_VERSION="v2.0.150",t.DEFAULT_KUBESCAPE_FRAMEWORKS=["all"]},928:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,n)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(761),t),n(r(824),t),n(r(645),t),n(r(974),t)},824:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,n)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.expend=t.exists=void 0;const l=o(r(147)),s=o(r(37)),i=o(r(17));t.exists=async function(e){try{return await l.promises.access(e),!0}catch(e){if("ENOENT"===e.code)return!1;throw e}},t.expend=function(e){let t=i.normalize(e);if(t.length<=0)return t;"~"===t[0]&&(t=i.join(s.homedir(),t.slice(1)));for(const e of Object.keys(process.env)){const r=process.env[e],a="$"+e;r&&(t=t.replace(a,r))}return t}},645:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0,function(e){e[e.Debug=0]="Debug",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info"}(r||(r={}));class a{constructor(){a._instance||(a._instance=this)}static log(e,t,a){let n=console.debug,o=`[Kubescape] ${(new Date).toISOString().replace(/T/," ").replace(/\..+/,"")}`;switch(e){case r.Debug:return void n({info:o,content:t});case r.Error:o=`${o} - error - `,n=console.error;break;case r.Warning:o=`${o} - warn  - `,n=console.warn;break;case r.Info:o=`${o} - info  - `,n=console.info}o+=t,n(o)}static debug(e,t=!1){this.log(r.Debug,e,t)}static error(e,t=!1){this.log(r.Error,e,t)}static info(e,t=!1){this.log(r.Info,e,t)}static warning(e,t=!1){this.log(r.Warning,e,t)}}t.Logger=a,Object.defineProperty(a,"_instance",{enumerable:!0,configurable:!0,writable:!0,value:new a})},974:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stopPropagation=t.prevDefault=void 0,t.prevDefault=function(e){return function(t){if("A"!==t.target.tagName)return t.preventDefault(),t.stopPropagation(),e(t)}},t.stopPropagation=function(e){e.stopPropagation()}},147:e=>{"use strict";e.exports=require("fs")},37:e=>{"use strict";e.exports=require("os")},17:e=>{"use strict";e.exports=require("path")},931:e=>{"use strict";e.exports=global.LensExtensions},361:e=>{"use strict";e.exports=global.Mobx},93:e=>{"use strict";e.exports=global.MobxReact},104:e=>{"use strict";e.exports=global.React}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var o=t[a]={id:a,exports:{}};return e[a].call(o.exports,o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nc=void 0;var a=r(553);module.exports=a})();